<!doctype html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/png" href="/assets/design/favicon.png" />

  <title>IPv6 setup on a Debian 9 VPS — Dean&#39;s blog</title>
  <meta name="description" content="IPv6 isn’t new at all, but it’s stunning to see how much the web isn’t ready for it at all!But that can change, and making your webserver compatible with it ...">
  <meta name="author" content="Thomas Durand">
  <meta name="generator" content="Jekyll v4.0.0">

  <meta itemprop="name" content="IPv6 setup on a Debian 9 VPS — Dean&#39;s blog">
  <meta itemprop="description" content="IPv6 isn’t new at all, but it’s stunning to see how much the web isn’t ready for it at all!But that can change, and making your webserver compatible with it ...">
  <meta itemprop="image" content="/assets/design/favicon192.png">

  <meta property="og:url" content="https://www.thomasdurand.fr/server/configuration/2019/04/14/ipv6-setup-on-ovh-vps.html">
  <meta property="og:type" content="article">
  <meta property="og:title" content="IPv6 setup on a Debian 9 VPS — Dean&#39;s blog">
  <meta property="og:description" content="IPv6 isn’t new at all, but it’s stunning to see how much the web isn’t ready for it at all!But that can change, and making your webserver compatible with it ...">
  <meta property="og:image" content="/assets/design/favicon192.png">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="IPv6 setup on a Debian 9 VPS — Dean&#39;s blog">
  <meta name="twitter:description" content="IPv6 isn’t new at all, but it’s stunning to see how much the web isn’t ready for it at all!But that can change, and making your webserver compatible with it ...">
  <meta name="twitter:image" content="/assets/design/favicon192.png">

  <meta name="apple-mobile-web-app-title" content="Dean&#39;s blog">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/design/favicon57.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/design/favicon76.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/design/favicon120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/design/favicon152.png">
  <link rel="apple-touch-icon" sizes="167x167" href="/assets/design/favicon167.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/design/favicon180.png">
  <link rel="icon" sizes="192x192" href="/assets/design/favicon192.png">
  <link rel="icon" sizes="128x128" href="/assets/design/favicon128.png">

  <link rel="stylesheet" href="/assets/css/style.css?v=201911041552">
  <link rel="canonical" href="https://www.thomasdurand.fr/server/configuration/2019/04/14/ipv6-setup-on-ovh-vps.html">
  <link type="application/atom+xml" rel="alternate" href="https://www.thomasdurand.fr/feed.xml" title="Dean's blog" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">
      <img src="/assets/design/logo@2x.png" height="40" alt="Dean's blog"/>
    </a>

    <nav class="site-nav">
      <a class="page-link" href="/">Stories</a>
      <a class="page-link" href="/about/">About</a>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">IPv6 setup on a Debian 9 VPS</h1>
    <p class="post-date"><time datetime="2019-04-14T14:00:00+02:00" itemprop="datePublished">Apr 14, 2019</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Thomas Durand</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    
    <p>IPv6 isn’t new at all, but it’s stunning to see how much the web isn’t ready for it at all!</p>

<p>But that can change, and making your webserver compatible with it is a great start!</p>

<!--more-->

<p>Today I discovered that my server had a IPv6 address assigned, but was not configured by default.</p>
      <h2 id="identify-your-ipv6-address-and-gateway">
        
        
          <a href="#identify-your-ipv6-address-and-gateway" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Identify your IPv6 address and gateway
        
        
      </h2>

<p>At OVH, two IPv6 informations are given along the IPv4:</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Full Address</th>
      <th>Shortened Address</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>IPv6</td>
      <td><code class="highlighter-rouge">2001:41d0:0305:2100:0000:0000:0000:10f2</code></td>
      <td><code class="highlighter-rouge">2001:41d0:305:2100::10f2</code></td>
    </tr>
    <tr>
      <td>Gateway</td>
      <td><code class="highlighter-rouge">2001:41d0:0305:2100:0000:0000:0000:0001</code></td>
      <td><code class="highlighter-rouge">2001:41d0:305:2100::1</code></td>
    </tr>
  </tbody>
</table>

<p>Since only one address is available, the network prefix, alias netmask is <code class="highlighter-rouge">128</code>.</p>
    
      <h2 id="setting-up-the-network">
        
        
          <a href="#setting-up-the-network" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Setting up the network
        
        
      </h2>

<p>Using root access, you should edit <code class="highlighter-rouge">/etc/network/interfaces</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>nano /etc/network/interfaces</code></pre></figure>

<p>By default, this file contains only the IPv4 settings:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># This file describes the network interfaces available on your system</span>
<span class="c"># and how to activate them. For more information, see interfaces(5).</span>

<span class="nb">source</span> /etc/network/interfaces.d/<span class="k">*</span>

<span class="c"># The loopback network interface</span>
auto lo
iface lo inet loopback

<span class="c"># The primary network interface</span>
allow-hotplug ens3
iface ens3 inet dhcp</code></pre></figure>

<p>You want to edit this file to add the IPv6 loopback and settings.<br />
You can try <code class="highlighter-rouge">auto</code> settings ; but in my case, I had to use the static network settings:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">iface lo inet6 loopback

iface ens3 inet6 static
    address 2001:41d0:305:2100::10f2
    netmask 128

    post-up /sbin/ip <span class="nt">-f</span> inet6 route add 2001:41d0:305:2100::1 dev ens3
    post-up /sbin/ip <span class="nt">-f</span> inet6 route add default via 2001:41d0:305:2100::1
    pre-down /sbin/ip <span class="nt">-f</span> inet6 route del 2001:41d0:305:2100::1 dev ens3
    pre-down /sbin/ip <span class="nt">-f</span> inet6 route del default via 2001:41d0:305:2100::1</code></pre></figure>
    
      <h2 id="testing-the-networking-configuration">
        
        
          <a href="#testing-the-networking-configuration" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Testing the Networking configuration
        
        
      </h2>

<p>First, you want to test the configuration to make sure your server is correctly setted up, and will not end up unaccessible from the outside world at the first reboot.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>ifup <span class="nt">-a</span> <span class="nt">--no-act</span> <span class="p">;</span> <span class="nb">echo</span> <span class="s2">"status: </span><span class="nv">$?</span><span class="s2">"</span></code></pre></figure>

<p>Expected output:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/run-parts --exit-on-error /etc/network/if-pre-up.d
/bin/run-parts --exit-on-error /etc/network/if-up.d
status: 0
</code></pre></div></div>

<p>If the status is not at 0, the configuration file have error, and you might wanna correct it before going further.</p>
    
      <h2 id="testing-ipv6">
        
        
          <a href="#testing-ipv6" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Testing IPv6
        
        
      </h2>

<p>Now that the configuration is correct, you can restart the networking service:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>service networking restart</code></pre></figure>

<p>And now you can test IPv6 using <code class="highlighter-rouge">ping6</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ping6 <span class="nt">-c</span> 4 google.com</code></pre></figure>

<p>If the ping resolves, your network is correctly setted up. Otherwise, your IPv6 settings are not okay.</p>
    
      <h2 id="declare-ipv6-support-in-your-dns-entries">
        
        
          <a href="#declare-ipv6-support-in-your-dns-entries" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Declare IPv6 support in your DNS entries
        
        
      </h2>

<p>At your registar settings, you want to add a <code class="highlighter-rouge">AAAA</code> entry, corresponding to the IPv6 DNS resolution.</p>

<p>Your entry should look like something like that:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IN AAAA 2001:41d0:305:2100:0:0:0:10f2
</code></pre></div></div>
<p><em>(here the example for thomasdurand.fr)</em></p>
    
      <h2 id="configure-your-http-server">
        
        
          <a href="#configure-your-http-server" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Configure your HTTP server
        
        
      </h2>

<p>Your HTTP server must listen to IPv6 address. You should make sure your HTTP server is correctly setted up.</p>

<p>For example, with Nginx, your <code class="highlighter-rouge">/etc/nginx/nginx.conf</code> file should contains IPv6 declarations:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server {
  listen 80; # IPv4
  listen [::]:80; # IPv6

  # and/or (if you're using SSL/TLS)

  listen 443 ssl; # IPv4
  listen [::]:443 ssl; # IPv6

  ...
}
</code></pre></div></div>
    
      <h2 id="testing-your-full-configuration">
        
        
          <a href="#testing-your-full-configuration" class="post-link-anchor"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#u"></use></svg></a> Testing your full configuration
        
        
      </h2>

<p>If you’re network is not IPv6 ready, there are online tools to test if your website supports IPv6. They’re great for troubleshooting.</p>

<p>I’ve used <a href="http://ipv6-test.com/validate.php">IPv6-test.com</a>.</p>
  </div>

</article>

<hr>

<div class="edit-section">
    <h3><a href="https://github.com/Dean151/Dean-Blog/edit/master/_posts/2019-04-14-ipv6-setup-on-ovh-vps.md" rel="nofollow" target="_blank" title="Edit on GitHub">Edit</a> or share this story:</h3>
    <ul>
        <li class="t">
            <a rel="nofollow" target="_blank" title="Share this story" href="https://twitter.com/intent/tweet?text=IPv6+setup+on+a+Debian+9+VPS&amp;url=https%3A%2F%2Fwww.thomasdurand.fr%2Fserver%2Fconfiguration%2F2019%2F04%2F14%2Fipv6-setup-on-ovh-vps.html&amp;via=deanatoire&amp;related=deanatoire">
                <svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#t"></use></svg>
            </a>
        </li>
        <li class="f">
            <a rel="nofollow" target="_blank" title="Share this story" href="https://facebook.com/sharer.php?u=https%3A%2F%2Fwww.thomasdurand.fr%2Fserver%2Fconfiguration%2F2019%2F04%2F14%2Fipv6-setup-on-ovh-vps.html">
                <svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#f"></use></svg>
            </a>
        </li>
        <li class="l">
            <a rel="nofollow" target="_blank" title="Share this story" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.thomasdurand.fr%2Fserver%2Fconfiguration%2F2019%2F04%2F14%2Fipv6-setup-on-ovh-vps.html&amp;title=IPv6+setup+on+a+Debian+9+VPS&amp;summary=IPv6+isn%E2%80%99t+new+at+all%2C+but+it%E2%80%99s+stunning+to+see+how+much+the+web+isn%E2%80%99t+ready+for+it+at+all%21But+that+can+change%2C+and+making+your+webserver+compatible+with+it+...&amp;source=https%3A%2F%2Fwww.thomasdurand.fr">
                <svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#l"></use></svg>
            </a>
        </li>
    </ul>
</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <img src="/assets/design/dean.jpg" class="profile-picture" alt="Profile picture">
        <h2 class="footer-heading">Thomas Durand (a.k.a. Dean)</h2>
        <ul class="description-list">
            <li>Software architect, code owner and security engineer at <a href="https://www.dilitrust.com/" target="_blank">DiliTrust</a> in Paris.</li>
            <li>Co-creator of a french amateur audiodrama, <a href="https://www.cafelembas.com/" target="_blank">Café & Lembas</a>.</li>
            <li>iOS and web developer, keen photographer, currently in love with <a href="https://swift.org/">Swift</a>.</li>
        </ul>
      </div>
      
      <div class="footer-col footer-col-2">
        <ul class="contact-list">
          <li>
              <a href="https://twitter.com/deanatoire" title="deanatoire" target="_blank" rel="nofollow"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#t"></use></svg>deanatoire</a>
          </li>
          <li>
              <a href="https://github.com/dean151" title="dean151" target="_blank" rel="nofollow"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#g"></use></svg>dean151</a>
          </li>
          <li>
              <a href="https://stackoverflow.com/users/2199197" title="dean" target="_blank" rel="nofollow"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#s"></use></svg>dean</a>
          </li>
          <li>
              <a href="https://www.linkedin.com/in/thomasdurandverjat" title="thomasdurandverjat" target="_blank" rel="nofollow"><svg class="svg-icon" viewBox="0 0 16 16"><use xlink:href="/assets/design/icons.svg#l"></use></svg>thomasdurandverjat</a>
          </li></ul>
      </div>
    </div>

  </div>

</footer>

<script src="/assets/js/scripts.js?v=201911041552"></script>

<script>
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    _paq.push(['setTrackerUrl', '/p/']);
    _paq.push(['setSiteId', '14']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.defer=true; g.src='/p/'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="/p/?idsite=14&rec=1" style="border:0;" alt="" /></p></noscript>



  </body>

</html>
