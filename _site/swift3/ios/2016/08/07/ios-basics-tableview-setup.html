<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/png" href="/assets/design/favicon.png" />

  <title>iOS basics: UITableView setup with Swift 3</title>
  <meta name="description" content="Updated for Swift 3 with Xcode 8.1">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/dist/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="canonical" href="https://www.thomasdurand.fr/swift3/ios/2016/08/07/ios-basics-tableview-setup.html">
  <link rel="alternate" type="application/rss+xml" title="Dean's blog" href="https://www.thomasdurand.fr/feed.xml">

  
  
  <link rel="alternate" hreflang="en" href="/swift3/ios/2016/08/07/ios-basics-tableview-setup.html" />
  
  <link rel="alternate" hreflang="fr" href="/swift3/ios/2016/08/07/bases-ios-configuration-tableview.html" />
  
  
  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">
      <img src="/assets/design/logo-en@2x.png" height="40" alt="Dean's blog"/>
    </a>

    <div class="langs en">
    
    
      <a href="/swift3/ios/2016/08/07/ios-basics-tableview-setup.html" class="en">en</a>
    
      <a href="/swift3/ios/2016/08/07/bases-ios-configuration-tableview.html" class="fr">fr</a>
    

    
    
    </div>

    <nav class="site-nav">
      
      
        
        <a class="page-link" href="/">Articles</a>
        
      
        
        <a class="page-link" href="/about/">About</a>
        
      
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">iOS basics: UITableView setup with Swift 3</h1>
    <p class="post-meta"><time datetime="2016-08-07T12:46:07+02:00" itemprop="datePublished">
    Aug 7, 2016



</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><strong>Updated for Swift 3 with Xcode 8.1</strong></p>

<p>Now that I begin to feel very familiar with <em>Swift</em> syntax and <em>iOS</em> app design ; and that I am totally convinced by how easy it is to do swift code, I want to share with you how to use it to make one of the more common UI and UX of <em>iOS</em> : a TableView presentation for <em>iOS</em> !</p>

<p>This is the first article about <em>iOS</em> development on this blog and I really hope I will manage to write more.</p>

<p><strong>Note:</strong> There is two methods to implement a dynamic table view : using a <code class="highlighter-rouge">UITableViewController</code>, or using a <code class="highlighter-rouge">UIViewController</code> that implements <code class="highlighter-rouge">UITableViewDelegate</code> and <code class="highlighter-rouge">UITableViewDataSource</code>. I will explain this second solution in this tutorial, not because it’s the simplest, but because it allow way more customizations for the layout of the TableView if you need to.</p>

<h3 id="what-were-gonna-build-from-scratch">What we’re gonna build from scratch</h3>

<p>We are going to achieve today is the list of all elements from the periodic elements, ordered by atomic number.</p>

<p><img src="/assets/ios/tutorial1/Screenshot.png" alt="Screenshot of the result" /></p>

<p>Thankfully, we’re not going to implement all of the atoms data in the code. Instead, we are going to fetch it from a plist file from an Apple sample code :</p>

<p><a href="/assets/ios/tutorial1/Elements.plist">Elements.plist</a></p>

<h3 id="first-about-mvc">First: about MVC</h3>

<p>MVC for “Model View Controller” is a pattern design that allow to separate different aspects of the code in an application :</p>

<ul>
  <li><strong>Model</strong>: Represent the data you want to display. In swift, it’s recommended to make struct oriented models instead of class oriented model ; but it depends on what you’re trying to achieve</li>
  <li><strong>View</strong>: Here in our tutorial, the view will be the <code class="highlighter-rouge">UITableView</code>. Views are what are presented to the user, and the user can interact with it.</li>
  <li><strong>Controller</strong>: To simplify, it’s the glue between your model, and your data. The user interact with the view, the view signal it to the controller, the controller update the data, and make the view follow those changes. When the data change, the controller is responsible to update the view accordingly</li>
</ul>

<p>In <em>iOS</em>, MVC is the most common pattern design, and UIKit is designed to be pro-MVC. The controller will be a subclass of <code class="highlighter-rouge">UIViewController</code>.
Every instances of <code class="highlighter-rouge">UIViewController</code> contains a <code class="highlighter-rouge">UIView</code> instance. That will be our main view.
We will create a <code class="highlighter-rouge">UITableView</code> instance that will be a subview of the main <code class="highlighter-rouge">UIView</code></p>

<p>Finally our data will be structured with a simple <em>Swift</em> struct.</p>

<h3 id="starting-the-project">Starting the project</h3>

<p>Open <em>Xcode 8</em> and create a new iOS project with the “One view” template. Name the project <code class="highlighter-rouge">ElementsList</code>.
Make sure that CoreData, Unit Tests and UI Tests are <em>unchecked</em>.</p>

<p>Xcode created a lot of files, that are listed on the left ; It’s the very basic of an iOS app : A storyboard to design views, a view controller that is the first controller of the app, and an AppDelegate that take care of the logic of the app life cycle.</p>

<p>Open the StoryBoard, and you’ll see a simple iOS empty view. One of the many way to make the UI of an app is to design the views and all the relations between them directly in this file. But the only thing we will do is to add a Navigation Controller for our app, that will allow us to have the iOS top navigation bar, and eventually to push new view controllers in a later tutorial.</p>

<p>To do so, select the view controller, and in the top menu, select <code class="highlighter-rouge">Editor &gt; Embed in &gt; Navigation Controller</code>.</p>

<p>This should add a view controller with a navigation bar, and an arrow lead now to our previous view controller. You just created your first Storyboard relation, congrats !</p>

<p>Next step is the model layer</p>

<h3 id="the-model-layer">The model layer</h3>

<p>A good start before implementing something is to think about how the data will be represented in our code.</p>

<p>If you didn’t already have, open the data file <a href="/assets/ios/tutorial1/Elements.plist">Elements.plist</a> and take a look at it.</p>

<p>We have a structure of an array of dictionaries. Each dictionary represent an element, and contains a lot of data. A good start would be to have all the data available in our model, to make sure we fit our future needs without redesigning the model later.</p>

<p>To create the model, create a new Swift file in the project, named <code class="highlighter-rouge">Element.swift</code>. In this file, we will implement the model layer.</p>

<p>Here is an example of model I came up with :</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">struct</span> <span class="kt">Element</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="kt">State</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">case</span> <span class="kt">Solid</span><span class="p">,</span> <span class="kt">Liquid</span><span class="p">,</span> <span class="kt">Gas</span><span class="p">,</span> <span class="kt">Artificial</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">atomicNumber</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">let</span> <span class="nv">atomicWeight</span><span class="p">:</span> <span class="kt">Float</span> <span class="c1">// in g.mol-1</span>
    <span class="k">let</span> <span class="nv">discoveryYear</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">group</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">period</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">let</span> <span class="nv">radioactive</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="k">let</span> <span class="nv">state</span><span class="p">:</span> <span class="kt">State</span>
    <span class="k">let</span> <span class="nv">symbol</span><span class="p">:</span> <span class="kt">String</span>

    <span class="c1">// Position in the table</span>
    <span class="k">let</span> <span class="nv">horizPos</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">let</span> <span class="nv">vertPos</span><span class="p">:</span> <span class="kt">Int</span>
<span class="p">}</span></code></pre></figure>

<p>Every data type is pretty simple in this example : Bool, Integers, Float and Strings ; but there is also an enum type. Enums are ideal when you only need to support a limited number of options. It’s the case here with an element state, that have only 4 possible values.</p>

<p>Note that I choose to make my enumeration inherit from String, witch mean each state is a string, and that we can try to convert a string to a State.</p>

<p>This model map all the data from <a href="/assets/ios/tutorial1/Elements.plist">apple plist</a> and will allow us to represent one element.
But what about the elements loading ? Right now, the elements are in a plist file, so we’ll need to create something that allow us to receive an <strong>array of all elements</strong></p>

<h3 id="loading-the-data">Loading the data</h3>

<p>Great, we have a model, and we have a plist file that contains our data. But we still need to translate the data in order to take advantage of our model.</p>

<p>I would implement it that way :</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">extension</span> <span class="kt">Element</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="kt">Error</span><span class="p">:</span> <span class="kt">ErrorProtocol</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">noPlistFile</span>
        <span class="k">case</span> <span class="n">cannotReadFile</span>
    <span class="p">}</span>

    <span class="c1">/// Load all the elements from the plist file</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">loadFromPlist</span><span class="p">()</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Element</span><span class="p">]</span> <span class="p">{</span>
        <span class="c1">// First we need to find the plist</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">file</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">path</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"Elements"</span><span class="p">,</span> <span class="nv">ofType</span><span class="p">:</span> <span class="s">"plist"</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="kt">ErrorType</span><span class="o">.</span><span class="n">noPlistFile</span>
        <span class="p">}</span>

        <span class="c1">// Then we read it as an array of dict</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">array</span> <span class="o">=</span> <span class="kt">NSArray</span><span class="p">(</span><span class="nv">contentsOfFile</span><span class="p">:</span> <span class="n">file</span><span class="p">)</span> <span class="k">as?</span> <span class="p">[[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]]</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="kt">ErrorType</span><span class="o">.</span><span class="n">cannotReadFile</span>
        <span class="p">}</span>

        <span class="c1">// Initialize the array</span>
        <span class="k">var</span> <span class="nv">elements</span><span class="p">:</span> <span class="p">[</span><span class="kt">Element</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">// For each dictionary</span>
        <span class="k">for</span> <span class="n">dict</span> <span class="k">in</span> <span class="n">array</span> <span class="p">{</span>
            <span class="c1">// We implement the element</span>
            <span class="k">let</span> <span class="nv">element</span> <span class="o">=</span> <span class="kt">Element</span><span class="o">.</span><span class="nf">from</span><span class="p">(</span><span class="nv">dict</span><span class="p">:</span> <span class="n">dict</span><span class="p">)</span>
            <span class="c1">// And add it to the array</span>
            <span class="n">elements</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// Return all elements</span>
        <span class="k">return</span> <span class="n">elements</span>
    <span class="p">}</span>

    <span class="c1">/// Create an element corresponding to the given dict</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">from</span><span class="p">(</span><span class="nv">dict</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Element</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">atomicNumber</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"atomicNumber"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">Int</span>
        <span class="k">let</span> <span class="nv">atomicWeight</span> <span class="o">=</span> <span class="kt">Float</span><span class="p">(</span><span class="n">dict</span><span class="p">[</span><span class="s">"atomicWeight"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span><span class="p">)</span> <span class="p">??</span> <span class="mi">0</span>
        <span class="k">let</span> <span class="nv">discoveryYear</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"discoveryYear"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span>
        <span class="k">let</span> <span class="nv">group</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"group"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">Int</span>
        <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span>
        <span class="k">let</span> <span class="nv">period</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"period"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">Int</span>
        <span class="k">let</span> <span class="nv">radioactive</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"radioactive"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span> <span class="o">==</span> <span class="s">"True"</span>
        <span class="k">let</span> <span class="nv">state</span> <span class="o">=</span> <span class="kt">State</span><span class="p">(</span><span class="nv">rawValue</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="s">"state"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span><span class="p">)</span><span class="o">!</span>
        <span class="k">let</span> <span class="nv">symbol</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"symbol"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span>
        <span class="k">let</span> <span class="nv">horizPos</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"horizPos"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">Int</span>
        <span class="k">let</span> <span class="nv">vertPos</span> <span class="o">=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"vertPos"</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">Int</span>

        <span class="k">return</span> <span class="kt">Element</span><span class="p">(</span><span class="nv">atomicNumber</span><span class="p">:</span> <span class="n">atomicNumber</span><span class="p">,</span>
                       <span class="nv">atomicWeight</span><span class="p">:</span> <span class="n">atomicWeight</span><span class="p">,</span>
                       <span class="nv">discoveryYear</span><span class="p">:</span> <span class="n">discoveryYear</span><span class="p">,</span>
                       <span class="nv">group</span><span class="p">:</span> <span class="n">group</span><span class="p">,</span>
                       <span class="nv">name</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                       <span class="nv">period</span><span class="p">:</span> <span class="n">period</span><span class="p">,</span>
                       <span class="nv">radioactive</span><span class="p">:</span> <span class="n">radioactive</span><span class="p">,</span>
                       <span class="nv">state</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span>
                       <span class="nv">symbol</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span>
                       <span class="nv">horizPos</span><span class="p">:</span> <span class="n">horizPos</span><span class="p">,</span>
                       <span class="nv">vertPos</span><span class="p">:</span> <span class="n">vertPos</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>That a lot of code, but it’s pretty strait forward, you just need to read it to understand it.</p>

<p>To test it, you can add in the <code class="highlighter-rouge">viewDidLoad()</code> method of your <code class="highlighter-rouge">ViewController</code> :</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">elements</span><span class="p">:</span> <span class="p">[</span><span class="kt">Element</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="c1">// Do any additional setup after loading the view, typically from a nib.</span>

        <span class="n">elements</span> <span class="o">=</span> <span class="k">try!</span> <span class="kt">Element</span><span class="o">.</span><span class="nf">loadFromPlist</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>When we check the Xcode console while executing, we find that the data is there ! Neat !</p>

<p><img src="/assets/ios/tutorial1/ElementsInConsole.png" alt="The loaded elements in the console" /></p>

<p><strong>Important</strong> : In <code class="highlighter-rouge">Element.from(dict: _)</code> function, there is a lot of force unwrapping <code class="highlighter-rouge">!</code> in the code. That’s because the data is implemented code side and cannot be changed easily. But in a real world application, implement it that way could cause crash when the data is not what you expected, and it will happen !</p>

<h3 id="creating-the-table-view">Creating the table view</h3>

<p>First, we need to create a UITableView instance, and keep reference to this instance. To do so, just add a property right below <code class="highlighter-rouge">var elements</code> :</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift">    <span class="k">var</span> <span class="nv">elements</span><span class="p">:</span> <span class="p">[</span><span class="kt">Element</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">weak</span> <span class="k">var</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="o">!</span> <span class="c1">// We make it weak for memory consideration</span></code></pre></figure>

<p>Then we need to create the tableview, by adding those line in <code class="highlighter-rouge">viewDidLoad()</code> :</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift">    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="o">...</span>
        <span class="k">let</span> <span class="nv">tableView</span> <span class="o">=</span> <span class="kt">UITableView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">tableView</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">tableView</span> <span class="o">=</span> <span class="n">tableView</span>

        <span class="n">tableView</span><span class="o">.</span><span class="n">dataSource</span> <span class="o">=</span> <span class="k">self</span>
        <span class="n">tableView</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
    <span class="p">}</span></code></pre></figure>

<p>As soon as you do this, the compiler should complain that <em>ViewController class does not conform</em> <code class="highlighter-rouge">UITableViewDataSource</code> and <code class="highlighter-rouge">UITableViewDelegate</code> protocols*</p>

<p>What should be do ? Well, let’s tell the compiler we implements them !
Add at the end of the file :</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UITableViewDataSource</span><span class="p">,</span> <span class="kt">UITableViewDelegate</span> <span class="p">{</span>

<span class="p">}</span></code></pre></figure>

<p>Right, now the compiler’s error have changed, and say we does not implement <code class="highlighter-rouge">UITableViewDataSource</code> protocol.</p>

<h3 id="configuring-the-table-view">Configuring the table view</h3>

<p>If we look in the documentation, we find out that <code class="highlighter-rouge">UITableViewDataSource</code> protocol contains two methods that are required to implement :</p>

<ul>
  <li><code class="highlighter-rouge">tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int</code> : Should return the number of rows in the given section of the tableview. In our example, we just have one section, so the implementation will be simple :</li>
</ul>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nv">section</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">elements</span><span class="o">.</span><span class="n">count</span>
<span class="p">}</span></code></pre></figure>

<ul>
  <li><code class="highlighter-rouge">tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell</code> : Should return a cell for the given IndexPath (IndexPath is a couple containing the number of the section and the number of the row)</li>
</ul>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>
    <span class="c1">// Getting the right element</span>
    <span class="k">let</span> <span class="nv">element</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>

    <span class="c1">// Instantiate a cell</span>
    <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="kt">UITableViewCell</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">subtitle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="s">"ElementCell"</span><span class="p">)</span>

    <span class="c1">// Adding the right informations</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">textLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">symbol</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">detailTextLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">name</span>

    <span class="c1">// Returning the cell</span>
    <span class="k">return</span> <span class="n">cell</span>
<span class="p">}</span></code></pre></figure>

<p>Now, you should build and run, and <em>voilà</em> your first tableview. But wait ! There is more !</p>

<h3 id="a-memory-problem">A memory problem</h3>

<p>If you build and run the application at the current state, it seems right. But <strong>it’s not !</strong></p>

<p>To understand why I’m saying that, during the debug session, use the memory footprint of your app in the Xcode debug console, and pay special attention on the memory as you scroll down and up in the app.</p>

<p><img src="/assets/ios/tutorial1/MemoryIssue.png" alt="Graphic of the memory growing up and up, diverging" /></p>

<p>What ? Just 33MB ? And that’s why you say something is wrong ? Yes it is wrong, because we can see that when we scroll, the memory footprint just rise, some memory is never released. Witch mean the app could (and will !) eventually experience a memory crash. (hugh !)</p>

<p>What is going on here ?</p>

<p>Well, remember our implementation of <code class="highlighter-rouge">cellForRowAt: indexPath</code> implementation ? It create a new cell everytime it is called by the tableview. Is it right ? No, it’s not.</p>

<p>What should I do ?</p>

<p>You should <strong>reuse</strong> the cells. And don’t freak out, it’s very easy to do !</p>

<h3 id="reusing-cells">Reusing cells</h3>

<p>As I said, it’s very easy to use reusable cells, and we did half the job previously : we already registered a cell for reuse ! Indeed, look at the code instantiating the cell, we have set a reuseIdentifier for the cell. So let just reuse it when we can.</p>

<p>What will be the logic ?</p>

<p>Well, we will try to reuse a cell, and if we cannot do so, we will create a new cell.</p>

<p>Just replace</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// Instantiate a cell</span>
<span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="kt">UITableViewCell</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">subtitle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="s">"ElementCell"</span><span class="p">)</span></code></pre></figure>

<p>With</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// Trying to reuse a cell</span>
<span class="k">let</span> <span class="nv">cellIdentifier</span> <span class="o">=</span> <span class="s">"ElementCell"</span>
<span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="n">cellIdentifier</span><span class="p">)</span>
    <span class="p">??</span> <span class="kt">UITableViewCell</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">subtitle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">cellIdentifier</span><span class="p">)</span></code></pre></figure>

<p>Now, when initializing a cell, we first try to reuse a cell, using <code class="highlighter-rouge">dequeueReusableCell(withIdentifier: _)</code>. This function will return a cell if it succeed, and nil if it fails.</p>

<p>Take a look at the second line.
The <code class="highlighter-rouge">??</code> operator uses the first value if it’s not nil, and will use the second value when the first value is nil.</p>

<p>This way, our cell will be reused if it can, and will be initialized from scratch just like we did before if it fails. We should always have a cell to handle from now on.</p>

<p>To be more specific, the dequeueReusableCell function will fail only the first time, because we did not registered any cell for the given identifier “ElementCell”. But then, dequeuing cells will work just fine, because Apple is able to create new cells when none of them are available for dequeuing.</p>

<h3 id="final-touches">Final touches</h3>

<p>Ok it begins to look right now. But I can enumerate 3 problems :</p>

<ol>
  <li>There is no title in the navigation bar</li>
  <li>If you touch a cell, it remains gray</li>
  <li>You told us elements would be ordered by atomic number ! (hydrogen first, helium then, etc…)</li>
</ol>

<p>So, let correct all of that, one to three lines of code per problem !</p>

<p>1) in <code class="highlighter-rouge">viewDidLoad</code>, at any place</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">navigationItem</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Periodic Elements"</span></code></pre></figure>

<p>The navigation item allow to customize how a ViewController will be displayed within a NavigationController. Here, we just want to set a title.</p>

<p>2) At the bottom of the file, inside the extension implementing <code class="highlighter-rouge">UITableViewDelegate</code></p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UITableViewDataSource</span><span class="p">,</span> <span class="kt">UITableViewDelegate</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">didSelectRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tableView</span><span class="o">.</span><span class="nf">deselectRow</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>As part of the <code class="highlighter-rouge">UITableViewDelegate</code>, we implement <code class="highlighter-rouge">tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath)</code> that is called as soon as a cell become selected. When it occurs, we ask the tableview to deselect the indexpath with an animation. Witch result a fade out of the selected cell as soon as it is selected, making the user knowing there is nothing to do by selecting cells for now in the application.</p>

<p>3) in <code class="highlighter-rouge">viewDidLoad</code>, right below <code class="highlighter-rouge">elements = try! Element.loadFromPlist()</code></p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">elements</span><span class="o">.</span><span class="nf">sort</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="p">{</span>
    <span class="nv">$0</span><span class="o">.</span><span class="n">atomicNumber</span> <span class="o">&lt;</span> <span class="nv">$1</span><span class="o">.</span><span class="n">atomicNumber</span>
<span class="p">})</span></code></pre></figure>

<p>This will sort the array right in place.
Swift 3 arrays have two functions to sort arrays :</p>

<ul>
  <li><code class="highlighter-rouge">sort</code> : Will sort the current array right in place, witch is possible only if the array is stored in a <code class="highlighter-rouge">var</code> (mutable). It returns nil</li>
  <li><code class="highlighter-rouge">sorted</code> : Will return a sorted copy of the array. It’s available on any array, mutating (<code class="highlighter-rouge">var</code>) or not (<code class="highlighter-rouge">let</code>)</li>
</ul>

<h3 id="its-a-wrap-">It’s a wrap !</h3>

<p>Now when you build the app, it as completely the behavior we expected.
If you need it, you can clone or download the project from <a href="https://github.com/Dean151/ElementsList/tree/tutorial-1">this branch on Github</a></p>

<p><img src="/assets/ios/tutorial1/Screenshot.png" alt="Screenshot of the result" /></p>

<h3 id="what-to-do-next-">What to do next ?</h3>

<p>I will write the next tutorials, witch should include:</p>

<ul>
  <li>A detail view to consult every properties of any element</li>
  <li>A search bar to find your element.</li>
  <li>A landscape mode with the element disposed like in the real table</li>
</ul>

<p>You can also try to do so by yourself ; using Apple documentation and any other blog !</p>


  </div>

  <div class="share-page">
    <h3>Share on:</h3>
    <ul>
    <li class="share-button share-twitter">
    	<a href="https://twitter.com/intent/tweet?text=iOS basics: UITableView setup with Swift 3&url=https://www.thomasdurand.fr/swift3/ios/2016/08/07/ios-basics-tableview-setup.html&via=deanatoire&related=deanatoire" rel="nofollow" target="_blank" title="Share on Twitter">
    	<span class="fa fa-twitter"></span> <span class="title">Twitter</span></a>
    </li>
    <li class="share-button share-facebook">
    	<a href="https://facebook.com/sharer.php?u=https://www.thomasdurand.fr/swift3/ios/2016/08/07/ios-basics-tableview-setup.html" rel="nofollow" target="_blank" title="Share on Facebook">
    	<span class="fa fa-facebook-official"></span> <span class="title">Facebook</span></a>
    </li>
    <li class="share-button share-linkedin">
    	<a href="http://www.linkedin.com/shareArticle?mini=true&url=https://www.thomasdurand.fr/swift3/ios/2016/08/07/ios-basics-tableview-setup.html&title=iOS basics: UITableView setup with Swift 3&summary=Dean's blog is a blog about computer science and development&source=https://www.thomasdurand.fr" rel="nofollow" target="_blank" title="Share on LinkedIn">
    	<span class="fa fa-linkedin-square"></span> <span class="title">LinkedIn</span></a>
    </li>
    </ul>
</div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Dean's blog</li>
          <li><a href="mailto:contact@thomasdurand.fr">contact@thomasdurand.fr</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3"></div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/dean151"><span class="fa fa-github"></span> <span class="username">dean151</span></a>
          </li>
          

          
          <li>
            <a href="https://linkedin.com/in/thomasdurandverjat"><span class="fa fa-linkedin"></span> <span class="username">thomasdurandverjat</span></a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/deanatoire"><span class="fa fa-twitter"></span> <span class="username">deanatoire</span></a>
          </li>
          

          <li>
            <a href="/feed.xml"><span class="fa fa-rss"></span> <span class="username">rss flux</span></a>
          </li>
        </ul>
      </div>
    </div>

  </div>

</footer>


    <script type="text/javascript">
      var _paq = _paq || [];
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        _paq.push(['setTrackerUrl', '/p/']);
        _paq.push(['setSiteId', '14']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src='/p/'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <noscript><p><img src="/p/?idsite=14&rec=1" style="border:0;" alt="" /></p></noscript>
  </body>

</html>
